const countriesData = {
  "×ª×œ ××‘×™×‘": {
    country: "×™×©×¨××œ",
    flag: "ðŸ‡®ðŸ‡±",
    timezone: "Asia/Jerusalem",
    coordinates: [32.0853, 34.7818],
    weather: {
      temp: 28,
      feelsLike: 30,
      condition: "×©×ž×©×™",
      icon: "â˜€ï¸",
      humidity: 65,
      windSpeed: 12,
      rainfall: 0,
    },
  },
  "× ×™×• ×™×•×¨×§": {
    country: '××¨×”"×‘',
    flag: "ðŸ‡ºðŸ‡¸",
    timezone: "America/New_York",
    coordinates: [40.7128, -74.006],
    weather: {
      temp: 22,
      feelsLike: 24,
      condition: "×©×ž×©×™",
      icon: "â˜€ï¸",
      humidity: 65,
      windSpeed: 12,
      rainfall: 0,
    },
  },
  ×œ×•× ×“×•×Ÿ: {
    country: "×‘×¨×™×˜× ×™×”",
    flag: "ðŸ‡¬ðŸ‡§",
    timezone: "Europe/London",
    coordinates: [51.5074, -0.1278],
    weather: {
      temp: 18,
      feelsLike: 17,
      condition: "×ž×¢×•× ×Ÿ",
      icon: "â˜ï¸",
      humidity: 75,
      windSpeed: 15,
      rainfall: 2.5,
    },
  },
  ×˜×•×§×™×•: {
    country: "×™×¤×Ÿ",
    flag: "ðŸ‡¯ðŸ‡µ",
    timezone: "Asia/Tokyo",
    coordinates: [35.6762, 139.6503],
    weather: {
      temp: 25,
      feelsLike: 27,
      condition: "×’×©×•×",
      icon: "ðŸŒ§ï¸",
      humidity: 80,
      windSpeed: 8,
      rainfall: 15,
    },
  },
  ×¤×¨×™×–: {
    country: "×¦×¨×¤×ª",
    flag: "ðŸ‡«ðŸ‡·",
    timezone: "Europe/Paris",
    coordinates: [48.8566, 2.3522],
    weather: {
      temp: 20,
      feelsLike: 21,
      condition: "×ž×¢×•× ×Ÿ ×—×œ×§×™×ª",
      icon: "â›…",
      humidity: 70,
      windSpeed: 10,
      rainfall: 0,
    },
  },
  ×¡×™×“× ×™: {
    country: "××•×¡×˜×¨×œ×™×”",
    flag: "ðŸ‡¦ðŸ‡º",
    timezone: "Australia/Sydney",
    coordinates: [-33.8688, 151.2093],
    weather: {
      temp: 23,
      feelsLike: 25,
      condition: "× ××”",
      icon: "ðŸŒ¤ï¸",
      humidity: 65,
      windSpeed: 18,
      rainfall: 0,
    },
  },
  ×“×•×‘××™: {
    country: "××™×—×•×“ ×”××ž×™×¨×•×™×•×ª",
    flag: "ðŸ‡¦ðŸ‡ª",
    timezone: "Asia/Dubai",
    coordinates: [25.2048, 55.2708],
    weather: {
      temp: 38,
      feelsLike: 42,
      condition: "×©×ž×©×™",
      icon: "ðŸŒž",
      humidity: 45,
      windSpeed: 14,
      rainfall: 0,
    },
  },
  ×ž×•×¡×§×‘×”: {
    country: "×¨×•×¡×™×”",
    flag: "ðŸ‡·ðŸ‡º",
    timezone: "Europe/Moscow",
    coordinates: [55.7558, 37.6173],
    weather: {
      temp: 15,
      feelsLike: 13,
      condition: "×ž×•×©×œ×’",
      icon: "ðŸŒ¨ï¸",
      humidity: 85,
      windSpeed: 20,
      rainfall: 8,
    },
  },
  ×‘×¨×œ×™×Ÿ: {
    country: "×’×¨×ž× ×™×”",
    flag: "ðŸ‡©ðŸ‡ª",
    timezone: "Europe/Berlin",
    coordinates: [52.52, 13.405],
    weather: {
      temp: 19,
      feelsLike: 20,
      condition: "×ž×¢×•× ×Ÿ ×—×œ×§×™×ª",
      icon: "â›…",
      humidity: 70,
      windSpeed: 15,
      rainfall: 0,
    },
  },
  ×‘× ×’×§×•×§: {
    country: "×ª××™×œ× ×“",
    flag: "ðŸ‡¹ðŸ‡­",
    timezone: "Asia/Bangkok",
    coordinates: [13.7563, 100.5018],
    weather: {
      temp: 32,
      feelsLike: 35,
      condition: "×’×©×•×",
      icon: "ðŸŒ§ï¸",
      humidity: 85,
      windSpeed: 8,
      rainfall: 20,
    },
  },
  ×§×”×™×¨: {
    country: "×ž×¦×¨×™×",
    flag: "ðŸ‡ªðŸ‡¬",
    timezone: "Africa/Cairo",
    coordinates: [30.0444, 31.2357],
    weather: {
      temp: 33,
      feelsLike: 35,
      condition: "×©×ž×©×™",
      icon: "â˜€ï¸",
      humidity: 40,
      windSpeed: 16,
      rainfall: 0,
    },
  },
  ×¨×•×ž×: {
    country: "××™×˜×œ×™×”",
    flag: "ðŸ‡®ðŸ‡¹",
    timezone: "Europe/Rome",
    coordinates: [41.9028, 12.4964],
    weather: {
      temp: 24,
      feelsLike: 26,
      condition: "×©×ž×©×™",
      icon: "â˜€ï¸",
      humidity: 60,
      windSpeed: 10,
      rainfall: 0,
    },
  },
  ×ž×“×¨×™×“: {
    country: "×¡×¤×¨×“",
    flag: "ðŸ‡ªðŸ‡¸",
    timezone: "Europe/Madrid",
    coordinates: [40.4168, -3.7038],
    weather: {
      temp: 26,
      feelsLike: 28,
      condition: "×©×ž×©×™",
      icon: "â˜€ï¸",
      humidity: 55,
      windSpeed: 12,
      rainfall: 0,
    },
  },
  ××ž×¡×˜×¨×“×: {
    country: "×”×•×œ× ×“",
    flag: "ðŸ‡³ðŸ‡±",
    timezone: "Europe/Amsterdam",
    coordinates: [52.3676, 4.9041],
    weather: {
      temp: 18,
      feelsLike: 17,
      condition: "×’×©×•×",
      icon: "ðŸŒ§ï¸",
      humidity: 80,
      windSpeed: 22,
      rainfall: 5,
    },
  },
  ×¡×™××•×œ: {
    country: "×“×¨×•× ×§×•×¨×™××”",
    flag: "ðŸ‡°ðŸ‡·",
    timezone: "Asia/Seoul",
    coordinates: [37.5665, 126.978],
    weather: {
      temp: 24,
      feelsLike: 26,
      condition: "×ž×¢×•× ×Ÿ ×—×œ×§×™×ª",
      icon: "â›…",
      humidity: 65,
      windSpeed: 12,
      rainfall: 0,
    },
  },
  ×˜×•×¨×•× ×˜×•: {
    country: "×§× ×“×”",
    flag: "ðŸ‡¨ðŸ‡¦",
    timezone: "America/Toronto",
    coordinates: [43.6532, -79.3832],
    weather: {
      temp: 15,
      feelsLike: 14,
      condition: "×ž×•×©×œ×’",
      icon: "ðŸŒ¨ï¸",
      humidity: 75,
      windSpeed: 20,
      rainfall: 10,
    },
  },
  "×¨×™×• ×“×” ×–×³× ×¨×•": {
    country: "×‘×¨×–×™×œ",
    flag: "ðŸ‡§ðŸ‡·",
    timezone: "America/Sao_Paulo",
    coordinates: [-22.9068, -43.1729],
    weather: {
      temp: 28,
      feelsLike: 30,
      condition: "×©×ž×©×™",
      icon: "â˜€ï¸",
      humidity: 70,
      windSpeed: 10,
      rainfall: 0,
    },
  },
  ××ª×•× ×”: {
    country: "×™×•×•×Ÿ",
    flag: "ðŸ‡¬ðŸ‡·",
    timezone: "Europe/Athens",
    coordinates: [37.9838, 23.7275],
    weather: {
      temp: 27,
      feelsLike: 29,
      condition: "×©×ž×©×™",
      icon: "â˜€ï¸",
      humidity: 60,
      windSpeed: 15,
      rainfall: 0,
    },
  },
  ×¡×˜×•×§×”×•×œ×: {
    country: "×©×•×•×“×™×”",
    flag: "ðŸ‡¸ðŸ‡ª",
    timezone: "Europe/Stockholm",
    coordinates: [59.3293, 18.0686],
    weather: {
      temp: 16,
      feelsLike: 15,
      condition: "×ž×¢×•× ×Ÿ",
      icon: "â˜ï¸",
      humidity: 70,
      windSpeed: 18,
      rainfall: 2,
    },
  },
  ×ž×•×ž×‘××™: {
    country: "×”×•×“×•",
    flag: "ðŸ‡®ðŸ‡³",
    timezone: "Asia/Kolkata",
    coordinates: [19.076, 72.8777],
    weather: {
      temp: 31,
      feelsLike: 34,
      condition: "×’×©×•×",
      icon: "ðŸŒ§ï¸",
      humidity: 85,
      windSpeed: 12,
      rainfall: 25,
    },
  },
};

// ×™×¦×™×¨×ª ×”×ž×¤×”
const map = L.map("map").setView([30, 0], 2);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
  attribution: "Â© OpenStreetMap contributors",
}).addTo(map);

// ×”×•×¡×¤×ª ×¡×ž× ×™× ×œ×ž×¤×”
Object.entries(countriesData).forEach(([city, data]) => {
  if (data.coordinates) {
    const marker = L.marker(data.coordinates)
      .bindPopup(
        `
                        <div class="map-popup">
                            <div>${data.flag}</div>
                            <div class="map-popup-temp">${data.weather.temp}Â°C</div>
                            <div class="map-popup-city">${city}</div>
                        </div>
                    `
      )
      .addTo(map);

    marker.on("click", () => {
      countrySelect.value = city;
      updateWeather(city);
    });
  }
});

const countrySelect = document.getElementById("countrySelect");

// ×ž×™×œ×•×™ ×¨×©×™×ž×ª ×”×ž×“×™× ×•×ª
Object.entries(countriesData).forEach(([city, data]) => {
  const option = document.createElement("option");
  option.value = city;
  option.textContent = `${data.flag} ${city}, ${data.country}`;
  countrySelect.appendChild(option);
});

function getLocalTime(timezone) {
  return new Date().toLocaleTimeString("he-IL", {
    timeZone: timezone,
    hour: "2-digit",
    minute: "2-digit",
  });
}

function updateWeather(city) {
  const data = countriesData[city];
  if (!data) return;

  // ×¢×“×›×•×Ÿ ×¤×¨×˜×™ ×”×ž×™×§×•×
  document.getElementById("countryFlag").textContent = data.flag;
  document.getElementById(
    "locationName"
  ).textContent = `${city}, ${data.country}`;
  document.getElementById("localTime").textContent = getLocalTime(
    data.timezone
  );

  // ×¢×“×›×•×Ÿ × ×ª×•× ×™ ×ž×–×’ ×”××•×•×™×¨
  document.getElementById("temperature").textContent = `${data.weather.temp}Â°`;
  document.getElementById("weatherIcon").textContent = data.weather.icon;
  document.getElementById("weatherCondition").textContent =
    data.weather.condition;
  document.getElementById("humidity").textContent = `${data.weather.humidity}%`;
  document.getElementById(
    "windSpeed"
  ).textContent = `${data.weather.windSpeed} ×§×ž"×©`;
  document.getElementById(
    "rainfall"
  ).textContent = `${data.weather.rainfall} ×ž"×ž`;
  document.getElementById(
    "feelsLike"
  ).textContent = `${data.weather.feelsLike}Â°`;

  // ×”×ª×ž×§×“×•×ª ×‘×ž×¤×”
  if (data.coordinates) {
    map.setView(data.coordinates, 6);
  }
}

// ×ž××–×™×Ÿ ××™×¨×•×¢×™× ×œ×©×™× ×•×™ ×‘×—×™×¨×ª ×ž×“×™× ×”
countrySelect.addEventListener("change", (e) => {
  updateWeather(e.target.value);
});

// ×¢×“×›×•×Ÿ ×©×¢×” ×›×œ ×“×§×”
setInterval(() => {
  if (countrySelect.value) {
    document.getElementById("localTime").textContent = getLocalTime(
      countriesData[countrySelect.value].timezone
    );
  }
}, 60000);
